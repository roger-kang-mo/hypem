<div
  id="hypem-main"
  ng-app="hypem"
  ng-controller="HypemController" ng-init="init(<%= @seed %>)">
  <nav class="navbar navbar-inverse navbar-fixed-top hypem-nav hypem-nav-main" role="navigation">
    <div class="container-fluid col-md-12">
      <div class="navbar-collapse collapsed">
        <a href class="navbar-brand" ng-click="showOptions()">Hypem</a>
        <div class="col-md-3 nav-col">
          <div class="btn" ng-click="playNextOrPrevious('previous')">
            <i class="fa fa-step-backward fa-inverse"></i>
          </div>
          <div class="btn" ng-click="audioPlayer.playPause()">
            <i class="fa fa-play fa-inverse" ng-class="{ 'fa-pause': audioPlayer.playing, 'fa-play': !audioPlayer.playing }"></i>
          </div>
          <div class="btn" ng-click="playNextOrPrevious('next')">
            <i class="fa fa-step-forward fa-inverse"></i>
          </div>
          <div class="btn" ng-click="setVolume(audioPlayer.volume - 0.1)">
            <span><i class="fa fa-volume-down fa-inverse"></i></span>
          </div>
          <div class="btn" ng-click="setVolume(audioPlayer.volume + 0.1)">
            <span><i class="fa fa-volume-up fa-inverse"></i></span>
          </div>
        </div>
        <div class="col-md-4 nav-col">
          <span class="inverse-text" ng-show="audioPlayer.currentTrack">{{ audioPlayer.$playlist[audioPlayer.currentTrack - 1].trackData.artist }} - {{ audioPlayer.$playlist[audioPlayer.currentTrack - 1].trackData.song }}</span>
        </div>
        <form class="col-md-4 query-form right-inner-addon pull-right" ng-submit="enterQuery(queryText)">
          <i class="fa fa-search"></i>
          <input type="text" ng-model="queryText" class="form-control" id="query">
          <input type="submit" class="hidden">
        </form>
        <div class="visible-xs col-md-1 side-toggle">
          <a href><i class="fa fa-bars fa-inverse" data-toggle="offcanvas"></i></a>
        </div>
      </div>
    </div>
  </nav>

  <nav class="navbar-collapse collapse navbar-inverse navbar lower-nav hypem-nav">
    <audio media-player="audioPlayer" data-playlist="currentPlaylist.tracks">
      <source type="audio/mp3">
    </audio>
    <div class="progress" ng-click="audioPlayer.seek(audioPlayer.duration * seekPercentage($event))">
      <div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" ng-style="{ width: (audioPlayer.currentTime || 0)*100/audioPlayer.duration + '%' }"></div>
      <div class="time audiotext" ng-show="audioPlayer.formatTime">
        <span>{{audioPlayer.formatTime}}</span><b>/</b><span>{{audioPlayer.formatDuration}}</span>
      </div>
    </div>
  </nav>

  <div id="hypem-body" class="container-fluid">
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-sm-3 col-md-2 sidebar-offcanvas" id="sidebar" role="navigation">
        <ul class="nav nav-sidebar">
          <li>
            <a href ng-hide="showAddPlaylistInput" focus-input ng-click="toggleAddPlaylist()"><i class="fa fa-plus"></i> Add a Playlist</a>
            <form ng-submit="createPlaylist(options.playlistName)">
              <input ng-show="showAddPlaylistInput" ng-model="options.playlistName" ng-blur="toggleAddPlaylist()" tooltip="Playlist Name" type="text" class="add-playlist-input">
              <input type="submit" class="hidden">
            </form>
          </li>
          <li ng-repeat="(listName, values) in trackLists" ng-class="{active: currentList == listName, disabled: loadingList == listName}" ng-click="setList(listName)">
            <a href>{{values['fakeName'] }}
              <span class="mini-text" ng-show="listName == 'hypemmain' || values['showUsername'] == true">({{listName}})</span>
              <i ng-show="loadingList == listName" class="fa fa-cog fa-spin"></i>
            </a>
          </li>
        </ul>
      </div>
      <div class="col-sm-9 col-md-10 main" infinite-scroll="paginateMe()">
        <ul>
          <div ng-repeat="track in currentTracks" class="track" ng-class="{ playing: track.trackData.download_url == currentlyPlaying.trackData.download_url }">
          <!-- <div ng-repeat="track in currentTracks" class="track" ng-class="{ playing: currentPlaylist.tracks[] }"> -->
            <div class="col-md-8">
              <h3 class="lead">{{track.trackData.song}}</h3>
              <h4 class="lead">{{track.trackData.artist}}</h4>
            </div>
            <div class="col-md-4">
              <div class="pull-right">
                <span>
                  <span ng-if="track.trackData.download_url.length">
                    <a href ng-click="setTrackUrl(track.trackData)" tooltip="Play"><i class="fa fa-play"></i></a>
                    <a target='_blank' tooltip="Download" href='{{track.trackData.download_url}}' alt='download' download='{{track.trackData.artist}} - {{track.trackData.song}}'>
                      <i class="fa fa-download" ng-show='track.trackData.download_url.length > 0'></i>
                    </a>
                  </span>
                  <a href ng-show='track.trackData.download_url.length == 0' tooltip="Unavailable for play or download">
                    <i class="fa fa-ban text-center"></i>
                  </a>
                  <a href tooltip="Add to Playlist"><i hm-popover='add_to_playlist_modal.html' title="Add to Playlist"  class="fa fa-list js-add-to-playlist"></i></a>
                </span>
              </div>
            </div>
          </div>
          <div colspan="5" ng-show="currentTracks.length == 0">Zero Tracks Found! User doesn't have any or we hit an error. ¯\_(ツ)_/¯</div>
        </ul>
      </div>
    </div>
  </div>
</div>



